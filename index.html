<!doctype html>

<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Fun-size Candee</title>
    <meta name="description" content="Official status of Oliver's impending arrival.">
    <meta name="author" content="zcandee">
  
    <style>
        body {font-family: "Tahoma MS",sans-serif;font-size:1.1em}
        section {display:block;max-width:40em;min-width:15em;margin:3em auto 0 auto;border:black solid 0.1em;text-align:center}
        h1 {float:left; padding:0 0.75em; margin:-0.75em 0 0 1em;background:#fff}
        p {font-size:3em}
        form {margin: 2em}
        form>p {font-size:1.1em; text-align:left}
        form label {display:inline-block; min-width:44%}
        form input,select {font-size:1.1em;display:inline-block; width:auto;min-width:54%}
        form:invalid button[type=submit] {display: none;}
        input:invalid:not(:placeholder-shown) {border:solid red}
        input[name=email],input[name=submitdate] {position: absolute; top:-100px}
        button {background:#fff; color:#000; border:#000 solid; min-width:5em; font-size:1.5em; padding:0.25em}
        button:hover {background:#000; color:#fff; border:#fff solid}
        #result.error {color:#f55}
        #result.success {color:#5f5}
    </style>
</head>

<body>
    <section>
        <h1>Has <i>Oliver</i> arrived?</h1>
        <p>Nope</p>
    </section>
    <section>
        <h1>Baby Pool</h1>
        <form id="entry" method="post" action="https://script.google.com/macros/s/AKfycbzYYkJ3DHeEzkwnt29cQw6OREXV3aG6NiRACbPRiVbqVlke2DA/exec" >
            <p><label for="contestant">Your Name:</label>
            <input type="email" name="email" placeholder="leave blank">
            <input id="contestant" name="contestant" placeholder="3 to 25 letters(A-Z only)" required pattern="[a-zA-Z -]{3,25}"></p>
            <p><label for="babyname"><i>Oliver's</i> Official Name:</label>
            <input id="babyname" name="babyname" placeholder="3 to 25 letters(A-Z only)" pattern="[a-zA-Z -]{3,25}"></p>
            <p><label for="sex"><i>Oliver's</i> Sex:</label>
            <select id="sex" name="sex">
                <option value="">Choose One...</option>
                <option value="boy">Boy</option>
                <option value="girl">Girl</option>
            </select></p>
            <p><label for="birthday"><i>Oliver's</i> Birthday:</label>
            <input type="datetime-local" id="birthday" name="birthday"></p>
            <p><label for="weight"><i>Oliver's</i> Weight (in pounds):</label>
            <input type="number" id="weight" name="weight" placeholder="7.5" min=0 max=20></p>
            <p><label for="length"><i>Oliver's</i> Length (in inches):</label>
            <input type="number" id="length" name="length" placeholder="19.5" min=0 max=40></p>
            <input type="text" name="submitdate" id="submitdate">
            <button id="submit" type="submit" value="submit">Submit</button><br>
            <span id="result"></span>
        </form>
    </section>
    <script>
        var form = document.getElementById('entry');
        var result = document.getElementById('result');
        document.getElementById('submitdate').value=new Date().toISOString(); 
        
        form.onkeypress = function (e) {return e.keyCode != 13;}
        form.onsubmit = function (e) {
            e.preventDefault();
            console.log(e);
            console.log(this.action);
            console.log(this.data);
            
            var xhr = new XMLHttpRequest();
            xhr.open("POST", this.action); 
            xhr.onload = function(e){ 
                console.log(e);
                form.reset();
                var resp = JSON.parse(e.target.responseText);
                if (resp['result']=="success") {
                    result.className="success";
                    result.innerHTML="Success! Thanks for playing!";
                } else {
                    result.className="error";
                    result.innerHTML=resp['error'];
                }
            }
            xhr.onerror = function(e){ 
                console.log(e);
                form.reset();
                result.className="error";
                result.innerHTML="Something went wrong, try again later.";
            }
            xhr.send(new FormData(form));
            
            return false;
        }
    </script>
</body>
</html>
